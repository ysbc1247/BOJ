# [Gold II] 굉장한 모비스터디 - 27726 

[문제 링크](https://www.acmicpc.net/problem/27726) 

### 성능 요약

메모리: 4752 KB, 시간: 88 ms

### 분류

자료 구조, 정렬, 분리 집합

### 문제 설명

<p>현대 모비스는 직원들이 소프트웨어 직무 교육을 이수할 수 있는 소프트웨어 아카데미를 2018년부터 운영하고 있다.</p>

<p>이 소프트웨어 아카데미에서는 총 세 번의 수업이 진행된다. 더 효과적인 학습을 위해 아카데미를 다니고 있는 $N$명의 직원들은 매 수업이 끝난 후 스터디를 진행하고자 한다.</p>

<p>스터디를 같이하는 구성원은 매 수업이 끝난 후 두 직원 간의 <strong>합의</strong>로 이루어진다. 만약 $a$번 직원과 $b$번 직원이 합의하였다면, 두 직원은 같이 스터디를 하게 된다. 이때 스터디를 같이 하는 직원들의 2명 이상의 모임을 <strong>모비스터디</strong>라고 한다. $a$번 직원과 $b$번 직원이 합의했고 $b$번 직원과 $c$번 직원 또한 합의했다면, $a$, $b$, $c$번 직원은 모두 같은 모비스터디이다.</p>

<p><strong>굉장한 모비스터디</strong>를 다음과 같이 정의하자.</p>

<ul>
	<li>어떤 직원들이 세 번의 스터디에서 모두 같은 모비스터디에 속하고,</li>
	<li>그 외의 직원들 중 어떤 직원도 이 모비스터디에 속한 직원들과 세 번의 스터디 모두를 같이 하지 않았다면</li>
</ul>

<p>이 모비스터디는 굉장한 모비스터디다.</p>

<p>굉장한 모비스터디를 찾자.</p>

### 입력 

 <p>첫째 줄에는 아카데미를 다니고 있는 직원의 수 $N\left(1\leq N \leq 100\, 000\right)$이 주어진다.</p>

<p>둘째 줄에는 세 번의 스터디에서 이루어진 합의의 수 $M_{1},M_{2},M_{3}$가 공백으로 구분되어 주어진다. $\left(1\leq M_{1},M_{2},M_{3}\leq 100\,000\right)$</p>

<p>이후 $M_{1}$개의 줄에는 첫 번째 스터디에서 합의한 서로 다른 두 직원의 번호 $a$와 $b$가 공백을 두고 주어진다. </p>

<p>이후 $M_{2}$개의 줄에는 두 번째 스터디에서 합의한 서로 다른 두 직원의 번호 $a$와 $b$가 공백을 두고 주어진다.</p>

<p>이후 $M_{3}$개의 줄에는 세 번째 스터디에서 합의한 서로 다른 두 직원의 번호 $a$와 $b$가 공백을 두고 주어진다.</p>

<p>$\left(a \neq b, 1\leq a,b \leq N \right)$</p>

<p>입력으로 주어지는 모든 값은 정수다.</p>

### 출력 

 <p>첫 번째 줄에는 굉장한 모비스터디의 수 $K$를 출력한다.</p>

<p>이후 $K$개의 줄에 걸쳐 굉장한 모비스터디에 포함된 직원들의 번호를 출력한다.</p>

<p>출력 형식은 다음과 같다.</p>

<ul>
	<li>서로 다른 굉장한 모비스터디의 경우 포함된 직원의 최소 번호가 더 작은 굉장한 모비스터디가 먼저 출력되어야한다.
	<ul>
		<li>예를 들어 두 굉장한 모비스터디가 각각 $\left\{3,4 \right\}$와 $\left\{1,2,5\right\}$라면 $\left\{1,2,5\right\}$가 먼저 출력되어야 한다. </li>
	</ul>
	</li>
	<li>같은 굉장한 모비스터디에 속한 직원들의 번호가 오름차순으로 정렬되어있어야 한다.
	<ul>
		<li>예를 들어 어떤 굉장한 모비스터디가 $\left\{3,2,6\right\}$이라면 $\left\{ 2,3,6 \right\}$과 같이 출력되어야 한다.</li>
	</ul>
	</li>
</ul>

